webpackJsonp([4],{18:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),u=a(r),l=n(13),i=a(l),o=n(31),d=a(o),s=function(e){var t=e.touched,n=e.error,a=(0,d["default"])(e,["touched","error"]),r=arguments.length<=1||void 0===arguments[1]?"errorText":arguments[1];return t&&n?(0,i["default"])({},a,(0,u["default"])({},r,n)):a};t["default"]=s},30:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),u=n(18),l=a(u),i=n(9);t["default"]=function(e){return(0,r.createElement)(i.TextField,(0,l["default"])(e))}},31:function(e,t){"use strict";t.__esModule=!0,t["default"]=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}},54:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),u=a(r),l=n(1),i=n(110),o=a(i),d=n(18),s=a(d);t["default"]=function(e){return(0,l.createElement)(o["default"],(0,u["default"])({},(0,s["default"])(e),{onChange:function(t,n,a){return e.onChange(a)}}))}},66:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),u=a(r),l=n(25),i=a(l),o=n(26),d=a(o),s=n(27),f=a(s),c=n(29),h=a(c),p=n(28),v=a(p),m=n(1),g=a(m),y={div:{textAlign:"center",margin:"5px 15px",height:200,width:500,borderLeft:"1px solid gray",borderRight:"1px solid gray",borderTop:"5px solid gray",borderBottom:"5px solid gray"},img:{height:200,width:500},text:{width:"100%",marginTop:20},input:{width:.1,height:.1,opacity:0,overflow:"hidden",position:"absolute",zIndex:-1}},_=function(e){function t(){var e,n,a,r;(0,d["default"])(this,t);for(var u=arguments.length,l=Array(u),o=0;u>o;o++)l[o]=arguments[o];return n=a=(0,h["default"])(this,(e=(0,i["default"])(t)).call.apply(e,[this].concat(l))),a.state={imagePreviewUrl:a.props.url,file:null},r=n,(0,h["default"])(a,r)}return(0,v["default"])(t,e),(0,f["default"])(t,[{key:"handlerImgChange",value:function(e){var t=this;e.preventDefault();var n=new FileReader,a=e.target.files[0];n.onloadend=function(){t.setState({file:a,imagePreviewUrl:n.result})},n.readAsDataURL(a),this.props.onChange(a)}},{key:"handleClick",value:function(){document.querySelector("#_file").click()}},{key:"render",value:function(){var e=this,t=null;return t=this.state.imagePreviewUrl?(0,u["default"])("img",{src:this.state.imagePreviewUrl,width:"100%",height:"100%"}):(0,u["default"])("div",{style:y.text},void 0,"点击选择上传图片"),(0,u["default"])("div",{onClick:this.handleClick,style:y.div},void 0,(0,u["default"])("input",{id:"_file",type:"file",readOnly:!0,onChange:function(t){return e.handlerImgChange(t)},style:y.input}),(0,u["default"])("div",{style:y.img},void 0,t))}}]),t}(g["default"].Component);t["default"]=_},101:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.uploadYunbook=t.uploadCover=void 0;var r=n(12),u=n(35),l=n(37),i=a(l),o=n(17),d=function(){return{type:r.UPLOAD_COVER_REQUEST}},s=function(){return{type:r.UPLOAD_COVER_SUCCESS}},f=function(e){return{type:r.UPLOAD_COVER_FAILURE,errorMessage:e}},c=(t.uploadCover=function(e){return function(t){t(d());var n=new FormData;return n.append("upload_file",e),(0,i["default"])(u.UPLOAD_COVER_API,{method:"POST",body:n}).then(function(e){if(e.ok)return e.json();throw new Error(e.statusText)}).then(function(e){if(e.code===u.OK)return t(s()),e.cover;throw new Error(e.msg)})["catch"](function(e){t(f(e.message)),o.toastr.error(e.message)})}},function(){return{type:r.UPLOAD_YUNBOOK_REQUEST}}),h=function(){return{type:r.UPLOAD_YUNBOOK_SUCCESS}},p=function(e){return{type:r.UPLOAD_YUNBOOK_FAILURE,errorMessage:e}};t.uploadYunbook=function(e){return e?function(t){t(c());var n=new FormData;return n.append("upload_file",e),(0,i["default"])(u.UPLOAD_YUNBOOK_API,{method:"POST",body:n}).then(function(e){if(e.ok)return e.json();throw new Error(e.statusText)}).then(function(e){if(e.code===u.OK)return t(h()),e;throw new Error(e.msg)})["catch"](function(e){t(p(e.message)),o.toastr.error(e.message)})}:void 0}},161:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),u=a(r),l=n(26),i=a(l),o=n(27),d=a(o),s=n(29),f=a(s),c=n(28),h=a(c),p=n(7),v=a(p),m=n(1),g=a(m),y=n(9),_=n(16),b=n(54),w=a(b),x={selectDiv:{display:"flex",justifyContent:"space-between"}},O=function(e){var t=[];return e.forEach(function(e){t.push((0,v["default"])(y.MenuItem,{value:e.aid,primaryText:e.title},e.aid))}),t},C=function(e){function t(){var e,n,a,r;(0,i["default"])(this,t);for(var l=arguments.length,o=Array(l),d=0;l>d;d++)o[d]=arguments[d];return n=a=(0,f["default"])(this,(e=(0,u["default"])(t)).call.apply(e,[this].concat(o))),a.state={select1:null,select2:null,select3:null},r=n,(0,f["default"])(a,r)}return(0,h["default"])(t,e),(0,d["default"])(t,[{key:"componentWillReceiveProps",value:function(){!this.state.select1&&this.props.select&&this.setState({select1:this.props.select[0],select2:this.props.select[1],select3:this.props.select[2]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.areas4,a=t.areas5,r=t.areas6,u=t.areas7,l=t.changeHandler,i=O(n),o=O(a),d=O(r),s=O(u),f=function(t,n){l(n,t).then(function(){5===t?(e.setState({select1:n}),o=O(a)):6===t?(e.setState({select2:n}),d=O(r)):7===t&&(e.setState({select3:n}),s=O(u))})};return(0,v["default"])("div",{style:x.selectDiv},void 0,(0,v["default"])(y.SelectField,{floatingLabelText:"分类",value:this.state.select1,onChange:function(e,t,n){f(5,n)}},void 0,i),g["default"].createElement(y.SelectField,{ref:"select2",floatingLabelText:"分类",value:this.state.select2,onChange:function(e,t,n){return f(6,n)}},o),g["default"].createElement(y.SelectField,{ref:"select3",floatingLabelText:"分类",value:this.state.select3,onChange:function(e,t,n){return f(7,n)}},d),(0,v["default"])(_.Field,{name:"aid",floatingLabelText:"分类",component:w["default"]},void 0,s))}}]),t}(g["default"].Component);t["default"]=C},1395:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.handleSubmit,n=e.submitting,a=e.invalid,r=e.reset,u=e.changeHandler,i=e.onChange,s=e.areas5,c=e.areas6,p=e.areas4,m=e.areas7;return(0,l["default"])("form",{onSubmit:t,style:y.form},void 0,(0,l["default"])(v["default"],{onChange:i}),(0,l["default"])(o.Field,{name:"title",type:"text",hintText:"云板书名称",floatingLabelText:"云板书名称",component:f["default"],style:y.item}),(0,l["default"])(o.Field,{name:"status",type:"text",hintText:"云板书状态",floatingLabelText:"云板书状态",component:h["default"],style:y.item},void 0,_,b),(0,l["default"])("div",{style:y.item},void 0,(0,l["default"])(g["default"],{areas4:p,areas5:s,areas6:c,areas7:m,changeHandler:u})),(0,l["default"])(o.Field,{name:"descript",hintText:"云板书简介",floatingLabelText:"云板书简介",component:f["default"],multiLine:!0,rows:2,style:y.item}),(0,l["default"])("div",{style:y.submit},void 0,(0,l["default"])(d.RaisedButton,{type:"submit",label:"提交新建",primary:!0,disabled:n||a}),(0,l["default"])(d.RaisedButton,{label:"取消",onClick:r,style:y.margin})))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(7),l=a(u),i=n(1),o=(a(i),n(16)),d=n(9),s=n(30),f=a(s),c=n(54),h=a(c),p=n(66),v=a(p),m=n(161),g=a(m),y={form:{display:"flex",flexFlow:"column wrap",alignItems:"center"},item:{width:"80%"},margin:{marginLeft:20},selectDiv:{display:"flex",justifyContent:"space-between",width:"80%"},submit:{display:"flex",width:"80%",flexFlow:"row wrap",marginTop:30}},_=(0,l["default"])(d.MenuItem,{primaryText:"仅自己可见",value:1}),b=(0,l["default"])(d.MenuItem,{primaryText:"所有人可见",value:2});t["default"]=r},1409:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),u=a(r),l=n(16),i=n(1395),o=a(i),d=n(102),s=n(21),f=n(41),c=n(80),h=n(101),p=n(17),v=function(e){var t={};return e.title||(t.title="请填写云板书名称"),e.aid||(t.aid="请选择分类"),t},m=function(e,t){return new u["default"](function(n,a){return e.file?void n(t((0,h.uploadYunbook)(e.file)).then(function(n){return n?(delete e.file,e.cover=n.cover,e.width=n.width,e.height=n.height,e.zoom=n.zoom,e.path=n.path,t((0,d.addYunbook)(e)).then(function(e){e&&t((0,f.push)("/yunbook/show/"+e))}),void 0):a()})):a(p.toastr.error("请选择封面"))})},g=function(e){return{areas4:e.area[4],areas5:e.area[5],areas6:e.area[6],areas7:e.area[7]}},y=function(e){return{changeHandler:function(t,n){return e((0,c.listAreaIfNeeded)({pid:t,zoom:n}))},onChange:function(t){e((0,l.change)("addYunbook","file",t))}}};t["default"]=(0,s.connect)(g,y)((0,l.reduxForm)({form:"addYunbook",validate:v,onSubmit:m,initialValues:{status:2}})(o["default"]))}});